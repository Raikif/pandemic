<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üì± Pandemic - Player</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #fff;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* ==================== JOIN SCREEN ==================== */
        .join-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .join-header {
            text-align: center;
            padding: 30px 0;
        }

        .join-logo {
            font-size: 50px;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .join-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            background: linear-gradient(135deg, #00ff88, #00b4d8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .join-subtitle {
            color: #666;
            margin-top: 5px;
        }

        .join-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            max-width: 400px;
            margin: 0 auto;
            width: 100%;
        }

        .join-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .join-card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: #00b4d8;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Code Input */
        .code-input-group {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .code-input {
            width: 45px;
            height: 55px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            text-align: center;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .code-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        .code-input.filled {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }

        /* Name Input */
        .name-input-group {
            margin-bottom: 20px;
        }

        .name-label {
            display: block;
            color: #888;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .name-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .name-input:focus {
            outline: none;
            border-color: #00b4d8;
            box-shadow: 0 0 15px rgba(0, 180, 216, 0.3);
        }

        .name-input::placeholder {
            color: #555;
        }

        /* Avatar Selection */
        .avatar-selection {
            margin-bottom: 20px;
        }

        .avatar-label {
            display: block;
            color: #888;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .avatar-option {
            width: 100%;
            aspect-ratio: 1;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar-option:hover {
            border-color: rgba(0, 180, 216, 0.5);
            transform: scale(1.05);
        }

        .avatar-option.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        /* Join Button */
        .join-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #00ff88 0%, #00b4d8 100%);
            border: none;
            border-radius: 12px;
            color: #000;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .join-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }

        .join-btn:disabled {
            background: linear-gradient(135deg, #333 0%, #444 100%);
            color: #666;
            cursor: not-allowed;
        }

        /* QR Scanner Button */
        .scan-btn {
            width: 100%;
            padding: 18px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .scan-btn:hover {
            background: rgba(255,255,255,0.15);
            border-color: #00b4d8;
        }

        .divider {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            color: #444;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255,255,255,0.1);
        }

        /* Error Message */
        .error-message {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            color: #ff6b6b;
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            display: none;
            align-items: center;
            gap: 10px;
        }

        .error-message.show {
            display: flex;
        }

        /* ==================== LOBBY SCREEN ==================== */
        .lobby-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
        }

        .lobby-screen.active {
            display: flex;
        }

        .join-screen.hidden {
            display: none;
        }

        .lobby-header {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .lobby-room-code {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 5px;
        }

        .lobby-room-code span {
            color: #00ff88;
            font-size: 1.2rem;
            letter-spacing: 3px;
        }

        .lobby-status {
            color: #00b4d8;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .lobby-status .spinner {
            width: 15px;
            height: 15px;
            border: 2px solid rgba(0, 180, 216, 0.3);
            border-top-color: #00b4d8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .lobby-content {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        /* Player Card (Self) */
        .my-player-card {
            background: linear-gradient(145deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 180, 216, 0.05) 100%);
            border: 2px solid rgba(0, 255, 136, 0.3);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
        }

        .my-avatar {
            width: 80px;
            height: 80px;
            background: rgba(0,0,0,0.3);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            border: 3px solid #00ff88;
        }

        .my-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .my-role {
            color: #888;
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .my-role span {
            color: #00b4d8;
            font-weight: 700;
        }

        .ready-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
        }

        .ready-label {
            color: #888;
        }

        .ready-switch {
            position: relative;
            width: 60px;
            height: 32px;
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .ready-switch.active {
            background: #00ff88;
        }

        .ready-switch::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 24px;
            height: 24px;
            background: #fff;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .ready-switch.active::before {
            transform: translateX(28px);
        }

        .ready-status {
            font-weight: 700;
            color: #666;
        }

        .ready-status.active {
            color: #00ff88;
        }

        /* Other Players */
        .other-players {
            flex: 1;
        }

        .other-players-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 15px;
        }

        .other-players-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .other-player {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.05);
            padding: 12px 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .other-player.ready {
            border-color: rgba(0, 255, 136, 0.3);
        }

        .other-player-avatar {
            font-size: 1.5rem;
        }

        .other-player-name {
            font-weight: 600;
        }

        .other-player-status {
            margin-left: auto;
            font-size: 1rem;
        }

        /* Leave Button */
        .lobby-footer {
            padding: 20px;
            background: rgba(0,0,0,0.2);
        }

        .leave-btn {
            width: 100%;
            padding: 15px;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: 12px;
            color: #ff6b6b;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .leave-btn:hover {
            background: rgba(255, 68, 68, 0.2);
        }

        /* ==================== GAME SCREEN ==================== */
        .game-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
            padding-bottom: 80px; /* Space for action panel */
        }

        .game-screen.active {
            display: flex;
        }

        /* Game Header */
        .game-header {
            background: rgba(0,0,0,0.5);
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .game-turn-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .turn-indicator {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .turn-indicator.my-turn {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            animation: pulse 1s infinite;
        }

        .turn-indicator.waiting {
            background: rgba(255,255,255,0.1);
            color: #888;
        }

        .actions-left {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Orbitron', sans-serif;
        }

        .actions-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00ff88;
        }

        .actions-label {
            font-size: 0.75rem;
            color: #888;
        }

        /* Timer */
        .turn-timer {
            background: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
        }

        .turn-timer.warning {
            color: #ffaa00;
        }

        .turn-timer.danger {
            color: #ff4444;
            animation: blink 0.5s infinite;
        }

        @keyframes blink {
            50% { opacity: 0.5; }
        }

        /* Game Status Bar */
        .game-status-bar {
            background: rgba(0,0,0,0.3);
            padding: 10px 15px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .status-item {
            text-align: center;
        }

        .status-icon {
            font-size: 1.2rem;
            margin-bottom: 3px;
        }

        .status-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .status-value.danger { color: #ff4444; }
        .status-value.warning { color: #ffaa00; }
        .status-value.safe { color: #00ff88; }

        /* Main Content */
        .game-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Location Display */
        .current-location {
            background: linear-gradient(135deg, rgba(0, 180, 216, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .location-label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 5px;
        }

        .location-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .location-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }

        .location-color.blue { background: #00b4d8; }
        .location-color.yellow { background: #ffd60a; }
        .location-color.black { background: #888; }
        .location-color.red { background: #ff4444; }

        .location-disease {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }

        .disease-cube-small {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }

        .disease-cube-small.blue { background: #00b4d8; }
        .disease-cube-small.yellow { background: #ffd60a; }
        .disease-cube-small.black { background: #666; }
        .disease-cube-small.red { background: #ff4444; }

        /* Actions Panel */
        .actions-panel {
            padding: 15px;
            background: rgba(0,0,0,0.2);
        }

        .actions-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 12px;
            text-align: center;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            padding: 12px 5px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: #fff;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn:hover:not(:disabled) {
            background: rgba(0, 180, 216, 0.1);
            border-color: rgba(0, 180, 216, 0.5);
        }

        .action-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .action-btn.active {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
        }

        .action-btn i {
            font-size: 1.3rem;
        }

        .action-btn.move i { color: #00b4d8; }
        .action-btn.treat i { color: #00ff88; }
        .action-btn.build i { color: #ffd60a; }
        .action-btn.share i { color: #ff6b6b; }
        .action-btn.cure i { color: #aa66ff; }
        .action-btn.fly i { color: #ff66aa; }
        .action-btn.charter i { color: #66ffaa; }
        .action-btn.shuttle i { color: #ff9966; }

        /* Cards Section */
        .cards-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
            min-height: 0;
        }

        .cards-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .cards-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: #888;
        }

        .cards-count {
            background: rgba(255,255,255,0.1);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
        }

        .cards-hand {
            flex: 1;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            scroll-snap-type: x mandatory;
        }

        .cards-hand::-webkit-scrollbar {
            height: 4px;
        }

        .cards-hand::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
        }

        /* Card */
        .card {
            flex-shrink: 0;
            width: 100px;
            height: 140px;
            border-radius: 12px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            transition: all 0.3s;
            scroll-snap-align: center;
            position: relative;
            border: 2px solid transparent;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card.selected {
            transform: translateY(-10px);
            border-color: #fff;
            box-shadow: 0 10px 30px rgba(255,255,255,0.2);
        }

        .card.blue {
            background: linear-gradient(135deg, #00b4d8 0%, #0077b6 100%);
        }

        .card.yellow {
            background: linear-gradient(135deg, #ffd60a 0%, #ffc300 100%);
            color: #000;
        }

        .card.black {
            background: linear-gradient(135deg, #555 0%, #333 100%);
        }

        .card.red {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
        }

        .card.event {
            background: linear-gradient(135deg, #aa66ff 0%, #7733cc 100%);
        }

        .card-city {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.7rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .card-icon {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .card-type {
            font-size: 0.65rem;
            text-align: center;
            opacity: 0.8;
        }

        /* End Turn Button */
        .end-turn-section {
            padding: 15px;
            background: rgba(0,0,0,0.3);
        }

        .end-turn-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #ff006e 0%, #ff4444 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .end-turn-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 0, 110, 0.3);
        }

        .end-turn-btn:disabled {
            background: linear-gradient(135deg, #333 0%, #444 100%);
            color: #666;
            cursor: not-allowed;
        }

        /* ==================== MODALS ==================== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, rgba(30,30,50,0.98) 0%, rgba(20,20,40,0.98) 100%);
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: #00b4d8;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Move Modal - Cities List */
        .cities-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .city-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .city-option:hover {
            background: rgba(0, 180, 216, 0.1);
            border-color: rgba(0, 180, 216, 0.5);
        }

        .city-option-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .city-option-name {
            flex: 1;
            font-weight: 600;
        }

        .city-option-distance {
            color: #888;
            font-size: 0.85rem;
        }

        /* Share Modal - Players List */
        .share-players-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .share-player-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .share-player-option:hover {
            background: rgba(0, 180, 216, 0.1);
            border-color: rgba(0, 180, 216, 0.5);
        }

        .share-player-avatar {
            font-size: 1.5rem;
        }

        .share-player-info {
            flex: 1;
        }

        .share-player-name {
            font-weight: 600;
        }

        .share-player-role {
            font-size: 0.8rem;
            color: #888;
        }

        /* Event Cards Modal */
        .event-cards-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .event-card-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .event-card-option:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateY(-2px);
        }

        .event-icon {
            font-size: 2rem;
            min-width: 40px;
            text-align: center;
        }

        .event-info {
            flex: 1;
        }

        .event-name {
            font-weight: 600;
            font-size: 1.05rem;
            color: #fff;
            margin-bottom: 4px;
        }

        .event-desc {
            font-size: 0.85rem;
            color: #aaa;
            line-height: 1.4;
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(0,0,0,0.9);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 15px 25px;
            z-index: 2000;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 90%;
            white-space: pre-line;
            text-align: left;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.success {
            border-color: rgba(0, 255, 136, 0.5);
        }

        .toast.error {
            border-color: rgba(255, 68, 68, 0.5);
        }

        .toast.info {
            border-color: rgba(0, 180, 216, 0.5);
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast.success .toast-icon { color: #00ff88; }
        .toast.error .toast-icon { color: #ff4444; }
        .toast.info .toast-icon { color: #00b4d8; }

        /* Game Over Modal */
        .game-over-content {
            text-align: center;
            padding: 30px 20px;
        }

        .game-over-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .game-over-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .game-over-title.win { color: #00ff88; }
        .game-over-title.lose { color: #ff4444; }

        .game-over-message {
            color: #888;
            margin-bottom: 25px;
        }

        .game-over-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #00ff88, #00b4d8);
            border: none;
            border-radius: 10px;
            color: #000;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
        }

        /* ==================== CARD DRAW MODAL ==================== */
        .card-draw {
            min-width: 350px;
            text-align: center;
        }

        .card-draw h3 {
            margin-bottom: 20px;
            color: #00ff88;
        }

        .card-draw-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card-deck {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .deck-card {
            width: 120px;
            height: 160px;
            background: linear-gradient(135deg, rgba(0,200,255,0.2), rgba(0,150,255,0.3));
            border: 2px solid rgba(0,200,255,0.5);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .deck-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0,200,255,0.4);
        }

        .deck-card.disabled,
        .deck-card[style*="pointer-events: none"] {
            opacity: 0.5 !important;
            cursor: not-allowed !important;
            filter: grayscale(0.5);
        }

        .deck-card.disabled:hover,
        .deck-card[style*="pointer-events: none"]:hover {
            transform: none !important;
            box-shadow: none !important;
        }

        .deck-card i {
            font-size: 48px;
            color: #00c8ff;
            margin-bottom: 10px;
        }

        .deck-label {
            font-size: 14px;
            color: white;
            font-weight: 600;
        }

        .deck-count {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }

        .drawn-card {
            min-height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-reveal {
            width: 140px;
            height: 180px;
            background: linear-gradient(135deg, rgba(255,200,0,0.2), rgba(255,150,0,0.3));
            border: 3px solid rgba(255,200,0,0.8);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: cardFlip 0.6s ease;
            box-shadow: 0 10px 40px rgba(255,200,0,0.4);
        }

        @keyframes cardFlip {
            0% { transform: rotateY(90deg) scale(0.5); opacity: 0; }
            100% { transform: rotateY(0deg) scale(1); opacity: 1; }
        }

        .card-reveal.epidemic {
            background: linear-gradient(135deg, rgba(255,50,50,0.3), rgba(200,0,0,0.4));
            border-color: rgba(255,50,50,0.9);
            box-shadow: 0 10px 40px rgba(255,50,50,0.5);
        }

        .card-reveal-icon {
            font-size: 64px;
            margin-bottom: 10px;
        }

        .card-reveal-name {
            font-size: 16px;
            font-weight: 700;
            color: white;
            text-align: center;
            padding: 0 10px;
        }

        .card-draw-progress {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .progress-text {
            color: #00ff88;
            font-size: 14px;
            font-weight: 600;
        }

        /* QR Scanner Modal */
        #qr-reader {
            border-radius: 10px;
            overflow: hidden;
            background: #000;
        }
        
        #qr-reader video {
            width: 100%;
            height: auto;
            display: block;
        }
        
        #qr-reader-results {
            color: #00ff88;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- ==================== JOIN SCREEN ==================== -->
    <div class="join-screen" id="joinScreen">
        <div class="join-header">
            <div class="join-logo">üåç</div>
            <h1 class="join-title">PANDEMIC</h1>
            <p class="join-subtitle">Gabung ke permainan</p>
        </div>

        <div class="join-content">
            <!-- Error Message -->
            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i>
                <span id="errorText">Kode room tidak ditemukan</span>
            </div>

            <!-- Code Entry -->
            <div class="join-card">
                <h2 class="join-card-title">
                    <i class="fas fa-keyboard"></i> Masukkan Kode Room
                </h2>
                
                <div class="code-input-group">
                    <input type="text" class="code-input" maxlength="1" data-index="0">
                    <input type="text" class="code-input" maxlength="1" data-index="1">
                    <input type="text" class="code-input" maxlength="1" data-index="2">
                    <input type="text" class="code-input" maxlength="1" data-index="3">
                    <input type="text" class="code-input" maxlength="1" data-index="4">
                    <input type="text" class="code-input" maxlength="1" data-index="5">
                </div>

                <div class="name-input-group">
                    <label class="name-label">Nama Kamu</label>
                    <input type="text" class="name-input" id="playerName" placeholder="Masukkan nama..." maxlength="15">
                </div>

                <div class="avatar-selection">
                    <label class="avatar-label">Pilih Avatar</label>
                    <div class="avatar-grid">
                        <div class="avatar-option selected" data-avatar="üßë‚Äçüî¨">üßë‚Äçüî¨</div>
                        <div class="avatar-option" data-avatar="üë®‚Äç‚öïÔ∏è">üë®‚Äç‚öïÔ∏è</div>
                        <div class="avatar-option" data-avatar="üë©‚Äçüî¨">üë©‚Äçüî¨</div>
                        <div class="avatar-option" data-avatar="üßë‚Äç‚úàÔ∏è">üßë‚Äç‚úàÔ∏è</div>
                        <div class="avatar-option" data-avatar="üë∑">üë∑</div>
                        <div class="avatar-option" data-avatar="ü¶∏">ü¶∏</div>
                        <div class="avatar-option" data-avatar="üßô">üßô</div>
                        <div class="avatar-option" data-avatar="üë®‚ÄçüöÄ">üë®‚ÄçüöÄ</div>
                        <div class="avatar-option" data-avatar="ü•∑">ü•∑</div>
                        <div class="avatar-option" data-avatar="üßõ">üßõ</div>
                    </div>
                </div>

                <button class="join-btn" id="joinBtn" disabled type="button">
                    <i class="fas fa-sign-in-alt"></i> GABUNG
                </button>
            </div>

            <div class="divider">atau</div>

            <button class="scan-btn" onclick="openScanner()">
                <i class="fas fa-qrcode"></i> Scan QR Code
            </button>
        </div>
    </div>

    <!-- ==================== LOBBY SCREEN ==================== -->
    <div class="lobby-screen" id="lobbyScreen">
        <div class="lobby-header">
            <div class="lobby-room-code">
                ROOM: <span id="displayRoomCode">------</span>
            </div>
            <div class="lobby-status">
                <div class="spinner"></div>
                <span>Menunggu host memulai game...</span>
            </div>
        </div>

        <div class="lobby-content">
            <!-- My Player Card -->
            <div class="my-player-card">
                <div class="my-avatar" id="myAvatar">üßë‚Äçüî¨</div>
                <div class="my-name" id="myName">Player</div>
                <div class="my-role">Role: <span id="myRole">Menunggu...</span></div>
                
                <div class="ready-toggle">
                    <span class="ready-label">Status:</span>
                    <div class="ready-switch" id="readySwitch" onclick="toggleReady()"></div>
                    <span class="ready-status" id="readyStatus">Belum Siap</span>
                </div>
            </div>

            <!-- Other Players -->
            <div class="other-players">
                <h3 class="other-players-title">PEMAIN LAIN</h3>
                <div class="other-players-list" id="otherPlayersList">
                    <!-- Will be populated dynamically -->
                    <div class="other-player">
                        <span class="other-player-avatar">‚è≥</span>
                        <span class="other-player-name">Menunggu pemain...</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="lobby-footer">
            <button class="leave-btn" onclick="leaveRoom()">
                <i class="fas fa-sign-out-alt"></i> Keluar dari Room
            </button>
        </div>
    </div>

    <!-- ==================== GAME SCREEN ==================== -->
    <div class="game-screen" id="gameScreen">
        <!-- Header -->
        <div class="game-header">
            <div class="game-turn-info">
                <div class="turn-indicator my-turn" id="turnIndicator">
                    <i class="fas fa-play"></i> GILIRAN KAMU
                </div>
            </div>
            
            <div class="actions-left" id="actionsDisplay">
                <span class="actions-count" id="actionsCount">4</span>
                <span class="actions-label">AKSI</span>
            </div>

            <div class="turn-timer" id="turnTimer">01:00</div>
        </div>

        <!-- Status Bar -->
        <div class="game-status-bar">
            <div class="status-item">
                <div class="status-icon">üí•</div>
                <div class="status-value" id="outbreakStatus">0/8</div>
            </div>
            <div class="status-item">
                <div class="status-icon">ü¶†</div>
                <div class="status-value" id="infectionStatus">2</div>
            </div>
            <div class="status-item">
                <div class="status-icon">üíä</div>
                <div class="status-value safe" id="curesStatus">0/4</div>
            </div>
            <div class="status-item">
                <div class="status-icon">üÉè</div>
                <div class="status-value" id="deckStatus">48</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="game-main">
            <!-- Current Location -->
            <div class="current-location">
                <div class="location-label">üìç LOKASI KAMU</div>
                <div class="location-name">
                    <span class="location-color blue"></span>
                    <span id="currentCity">Atlanta</span>
                    <span>üè•</span>
                </div>
                <div class="location-disease" id="locationDisease">
                    <div class="disease-cube-small blue"></div>
                    <div class="disease-cube-small blue"></div>
                </div>
            </div>

            <!-- Actions Panel -->
            <div class="actions-panel">
                <div class="actions-title">PILIH AKSI</div>
                <div class="actions-grid">
                    <button class="action-btn move" onclick="openMoveModal()">
                        <i class="fas fa-walking"></i>
                        <span>Jalan</span>
                    </button>
                    <button class="action-btn fly" onclick="openFlyModal()">
                        <i class="fas fa-plane"></i>
                        <span>Terbang</span>
                    </button>
                    <button class="action-btn treat" onclick="treatDisease()">
                        <i class="fas fa-medkit"></i>
                        <span>Obati</span>
                    </button>
                    <button class="action-btn build" onclick="buildStation()">
                        <i class="fas fa-hospital"></i>
                        <span>Bangun</span>
                    </button>
                    <button class="action-btn share" onclick="openShareModal()">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Berbagi</span>
                    </button>
                    <button class="action-btn cure" onclick="discoverCure()">
                        <i class="fas fa-flask"></i>
                        <span>Obat</span>
                    </button>
                    <button class="action-btn charter" onclick="charterFlight()">
                        <i class="fas fa-plane-departure"></i>
                        <span>Charter</span>
                    </button>
                    <button class="action-btn shuttle" onclick="shuttleFlight()">
                        <i class="fas fa-shuttle-van"></i>
                        <span>Shuttle</span>
                    </button>
                    <button class="action-btn event" onclick="useEventCard()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-bolt"></i>
                        <span>Event</span>
                    </button>
                </div>
            </div>

            <!-- Cards Section -->
            <div class="cards-section">
                <div class="cards-header">
                    <div class="cards-title">üÉè KARTU KAMU</div>
                    <div class="cards-count"><span id="handCount">0</span>/7</div>
                </div>
                <div class="cards-hand" id="cardsHand">
                    <!-- Sample Cards - Will be dynamic -->
                    <div class="card blue" onclick="selectCard(this)">
                        <div class="card-city">ATLANTA</div>
                        <div class="card-icon">üèôÔ∏è</div>
                        <div class="card-type">City</div>
                    </div>
                    <div class="card yellow" onclick="selectCard(this)">
                        <div class="card-city">LAGOS</div>
                        <div class="card-icon">üèôÔ∏è</div>
                        <div class="card-type">City</div>
                    </div>
                    <div class="card event" onclick="selectCard(this)">
                        <div class="card-city">AIRLIFT</div>
                        <div class="card-icon">‚úàÔ∏è</div>
                        <div class="card-type">Event</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- End Turn -->
        <div class="end-turn-section">
            <button class="end-turn-btn" id="endTurnBtn" onclick="endTurn()">
                <i class="fas fa-check-circle"></i> AKHIRI GILIRAN
            </button>
        </div>
    </div>

    <!-- ==================== MOVE MODAL ==================== -->
    <div class="modal-overlay" id="moveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-walking"></i> Pilih Kota Tujuan
                </h3>
                <button class="modal-close" onclick="closeModal('moveModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="cities-list" id="moveCitiesList">
                <div class="city-option" onclick="moveTo('Chicago')">
                    <span class="city-option-color" style="background: #00b4d8;"></span>
                    <span class="city-option-name">Chicago</span>
                    <span class="city-option-distance">Terhubung</span>
                </div>
                <div class="city-option" onclick="moveTo('Miami')">
                    <span class="city-option-color" style="background: #ffd60a;"></span>
                    <span class="city-option-name">Miami</span>
                    <span class="city-option-distance">Terhubung</span>
                </div>
                <div class="city-option" onclick="moveTo('Washington')">
                    <span class="city-option-color" style="background: #00b4d8;"></span>
                    <span class="city-option-name">Washington</span>
                    <span class="city-option-distance">Terhubung</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== FLY MODAL ==================== -->
    <div class="modal-overlay" id="flyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-plane"></i> Direct Flight
                </h3>
                <button class="modal-close" onclick="closeModal('flyModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p style="color: #888; margin-bottom: 15px; font-size: 0.9rem;">
                Buang kartu kota untuk terbang ke kota tersebut
            </p>
            <div class="cities-list" id="flyCitiesList">
                <!-- Will be populated with cards player has -->
            </div>
        </div>
    </div>

    <!-- ==================== SHARE MODAL ==================== -->
    <div class="modal-overlay" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-exchange-alt"></i> Berbagi Kartu
                </h3>
                <button class="modal-close" onclick="closeModal('shareModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p style="color: #888; margin-bottom: 15px; font-size: 0.9rem;">
                Pilih pemain di lokasi yang sama untuk berbagi kartu
            </p>
            <div class="share-players-list" id="sharePlayersList">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- ==================== EVENT MODAL ==================== -->
    <div class="modal-overlay" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-bolt"></i> Gunakan Kartu Event
                </h3>
                <button class="modal-close" onclick="closeModal('eventModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p style="color: #888; margin-bottom: 15px; font-size: 0.9rem;">
                Pilih kartu event yang ingin digunakan
            </p>
            <div class="event-cards-list" id="eventCardsList">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- ==================== GAME OVER MODAL ==================== -->
    <div class="modal-overlay" id="gameOverModal">
        <div class="modal-content game-over-content">
            <div class="game-over-icon" id="gameOverIcon">üèÜ</div>
            <h2 class="game-over-title win" id="gameOverTitle">MENANG!</h2>
            <p class="game-over-message" id="gameOverMessage">
                Selamat! Tim berhasil menemukan obat untuk semua penyakit!
            </p>
            <button class="game-over-btn" onclick="backToHome()">
                <i class="fas fa-home"></i> Kembali ke Menu
            </button>
        </div>
    </div>

    <!-- ==================== DISCARD MODAL ==================== -->
    <div class="modal-overlay" id="discardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üóëÔ∏è Buang Kartu</h3>
                <p>Maksimal 7 kartu. Pilih kartu untuk dibuang:</p>
            </div>
            <div class="modal-body">
                <div id="discardCardsList" class="discard-cards-grid"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="closeModal('discardModal')">Batal</button>
            </div>
        </div>
    </div>

    <!-- ==================== FORECAST MODAL ==================== -->
    <div class="modal-overlay" id="forecastModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üîÆ Forecast - Atur Urutan Infeksi</h3>
                <p>Drag kartu untuk mengatur urutan (atas = ditarik pertama):</p>
            </div>
            <div class="modal-body">
                <div id="forecastCardsList" class="forecast-cards-list"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn primary" onclick="confirmForecast()">Konfirmasi</button>
                <button class="modal-btn secondary" onclick="closeModal('forecastModal')">Batal</button>
            </div>
        </div>
    </div>

    <!-- ==================== RESILIENT POPULATION MODAL ==================== -->
    <div class="modal-overlay" id="resilientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üõ°Ô∏è Resilient Population - Hapus Kartu Infeksi</h3>
                <p>Pilih kartu dari discard pile untuk dihapus permanen:</p>
            </div>
            <div class="modal-body">
                <div id="resilientCardsList" class="resilient-cards-grid"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="closeModal('resilientModal')">Batal</button>
            </div>
        </div>
    </div>

    <!-- ==================== CARD DRAW MODAL ==================== -->
    <div class="modal-overlay" id="cardDrawModal">
        <div class="modal-content card-draw">
            <h3>üé¥ Ambil Kartu</h3>
            <div class="card-draw-area">
                <div class="card-deck" id="cardDeck">
                    <div class="deck-card player-deck" onclick="drawPlayerCard()">
                        <i class="fas fa-city"></i>
                        <div class="deck-label">Kartu Kota</div>
                        <div class="deck-count" id="playerDeckCount">0</div>
                    </div>
                </div>
                <div class="drawn-card" id="drawnCard"></div>
            </div>
            <div class="card-draw-progress">
                <div class="progress-text" id="cardDrawProgress">Ambil 2 kartu kota</div>
            </div>
            <button class="modal-btn" id="continueDrawBtn" onclick="continueAfterDraw()" style="display:none">Lanjut</button>
            <button class="modal-btn secondary" id="skipDrawBtn" onclick="skipDraw()" style="display:none; margin-top: 10px;">Skip (Langsung Infeksi)</button>
        </div>
    </div>

    <!-- ==================== TOAST NOTIFICATION ==================== -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle toast-icon"></i>
        <span id="toastMessage">Notifikasi</span>
    </div>

    <!-- html5-qrcode Library for QR Scanning -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    
    <script src="js/firebase-config.js"></script>
    <script src="js/player.js"></script>
</body>
</html>